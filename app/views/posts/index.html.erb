<h1>Demands</h1>

<% if user_signed_in? %>
<%= render 'form' %>
<% end %>

<% @posts.each do |post| %>
<p><%= post.description %></p>

<p><%= pluralize(post.get_upvotes.size, "Like") %> |
<%= pluralize(post.get_downvotes.size, "Dislike") %>
</p>
<p><%= link_to "Like", like_post_path(post), method: :get %> |
  <%= link_to "Dislike", dislike_post_path(post), method: :get %> </p>
<p>
  <% if post.user == current_user %>
  <%= link_to "Edit Post", edit_post_path(post) %> |
  <%= link_to "Delete Demand", post_path(post), method: :delete, data: { confirm: "Are you sure?" } %>
  <% end %>
</p>

<div class="comment">
  <strong class="commet-count"><%= pluralize(post.comments.count, "Comment")%></strong>
  <% post.comments.each do |comment| %>
  <p class="username"><%= comment.user.name %></p>
  <p class="content"><%= comment.content %></p>
  <% end %>
</div>

<% if user_signed_in? %>
  <%= form_for([post, post.comments.build]) do |f| %>
    <div class="comment">
      <%= f.text_area :content, :placeholder => "Comment on demand" %>
    </div>
    <%= f.submit %>
  <% end %>
<% end %>

<% end %>

<p><%= if user_signed_in?
   puts link_to "New Demand", new_post_path
 end%></p>
